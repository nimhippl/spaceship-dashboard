(function(){"use strict";var e={4081:function(e,t,r){var s=r(5130),n=r(6768);const i={id:"app"},o={id:"map-container"},a={class:"panel"},c={class:"indicators"},l={id:"control-panel-container"},u={key:0,id:"game-over"};function h(e,t,r,s,h,d){const v=(0,n.g2)("FlatMap"),f=(0,n.g2)("FuelGauge"),p=(0,n.g2)("ShipHealth"),g=(0,n.g2)("ConnectionStatus"),w=(0,n.g2)("ControlPanel");return(0,n.uX)(),(0,n.CE)("div",i,[t[2]||(t[2]=(0,n.Lk)("h1",null,"Панель управления космическим кораблем",-1)),(0,n.Lk)("div",o,[(0,n.bF)(v,{objects:h.mapObjects,currentX:h.currentX,currentY:h.currentY,viewX:h.viewX,viewY:h.viewY,fuelBarrels:h.fuelBarrels},null,8,["objects","currentX","currentY","viewX","viewY","fuelBarrels"])]),(0,n.Lk)("div",a,[(0,n.Lk)("div",c,[(0,n.bF)(f,{fuel:h.fuelLevel},null,8,["fuel"]),(0,n.bF)(p,{health:h.shipHealth},null,8,["health"]),(0,n.bF)(g,{status:h.connectionStatus},null,8,["status"])]),(0,n.Lk)("div",l,[(0,n.bF)(w,{onMove:d.moveShip},null,8,["onMove"])])]),h.gameOver?((0,n.uX)(),(0,n.CE)("div",u,[t[1]||(t[1]=(0,n.Lk)("h2",null,"Конец игры",-1)),(0,n.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>d.restartGame&&d.restartGame(...e))},"Попробовать снова")])):(0,n.Q3)("",!0)])}var d=r(4232),v=r.p+"img/fuel-barrel.61922e9e.svg";const f={id:"flat-map"},p=["width","height","viewBox"],g=["x","y","href"],w=["x","y"],b={key:0,class:"fuel-barrel-info"},m={class:"fuel-barrel-count"};function k(e,t,r,s,i,o){return(0,n.uX)(),(0,n.CE)("div",f,[((0,n.uX)(),(0,n.CE)("svg",{width:i.width,height:i.height,viewBox:o.viewBox,style:{background:"url('@/assets/stars-background.jpg') no-repeat center center / cover"}},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.scaledObjects,(e=>((0,n.uX)(),(0,n.CE)("image",{key:e.id,x:e.scaledX,y:e.scaledY,href:o.getObjectIcon(e.type),width:"100",height:"100"},null,8,g)))),128)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.scaledObjects,(e=>((0,n.uX)(),(0,n.CE)("text",{key:"label-"+e.id,x:e.scaledX+55,y:e.scaledY+25,"font-size":"14",fill:"white"},(0,d.v_)(e.name),9,w)))),128))],8,p)),r.fuelBarrels>0?((0,n.uX)(),(0,n.CE)("div",b,[t[0]||(t[0]=(0,n.Lk)("img",{src:v,alt:"Fuel Barrel",class:"fuel-barrel-icon"},null,-1)),(0,n.Lk)("span",m,"x "+(0,d.v_)(r.fuelBarrels),1)])):(0,n.Q3)("",!0)])}var y={props:["objects","currentX","currentY","fuelBarrels"],data(){return{width:1600,height:840,scaleFactor:3}},mounted(){console.log("Параметры viewBox:",this.viewBox)},computed:{viewBox(){const e=this.currentX*this.scaleFactor-this.width/2,t=this.currentY*this.scaleFactor-this.height/2,r=Math.min(0,e),s=Math.min(0,t);return console.log(`${this.currentY} ${t} ${r} ${s} ${this.width} ${this.height}`),`${r} ${s} ${this.width} ${this.height}`},viewBoxWidth(){return this.width},viewBoxHeight(){return this.height},scaledObjects(){return this.objects.map((e=>({...e,scaledX:e.x*this.scaleFactor,scaledY:e.y*this.scaleFactor})))}},methods:{getObjectIcon(e){switch(e){case"spaceship":return r(6169);case"asteroid":return r(2348);default:return""}}}},C=r(1241);const L=(0,C.A)(y,[["render",k],["__scopeId","data-v-2c231f46"]]);var X=L;const x={id:"fuel-gauge"},O={version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32",class:"fuel-svg"},_=["y","height","fill"];function j(e,t,r,s,i,o){return(0,n.uX)(),(0,n.CE)("div",x,[((0,n.uX)(),(0,n.CE)("svg",O,[t[0]||(t[0]=(0,n.Lk)("path",{id:"fuel_1_",d:"M26,31.36H6c-1.301,0-2.36-1.059-2.36-2.36V6c0-1.179,0.869-2.159,2-2.333V1c0-0.199,0.161-0.36,0.36-0.36h10\r\n        c0.199,0,0.36,0.161,0.36,0.36v2.64H26c1.302,0,2.36,1.059,2.36,2.36v23C28.36,30.302,27.302,31.36,26,31.36z",fill:"#444"},null,-1)),(0,n.Lk)("rect",{x:"7",y:31.36-r.fuel/100*25,width:"18",height:r.fuel/100*25,fill:o.fuelColor},null,8,_)])),(0,n.Lk)("p",null,"Запас топлива: "+(0,d.v_)(r.fuel)+"%",1)])}var S={props:{fuel:{type:Number,required:!0}},computed:{fuelColor(){return this.fuel<=20?"red":this.fuel<=60?"yellow":"green"}}};const E=(0,C.A)(S,[["render",j],["__scopeId","data-v-98c00982"]]);var Y=E;const B={id:"ship-health"},F={class:"health-bar"};function $(e,t,r,s,i,o){return(0,n.uX)(),(0,n.CE)("div",B,[(0,n.Lk)("div",F,[(0,n.Lk)("div",{class:"health-fill",style:(0,d.Tr)({width:r.health+"%"})},null,4)]),(0,n.Lk)("p",null,"Прочность корабля: "+(0,d.v_)(r.health)+"%",1)])}var M={props:["health"]};const H=(0,C.A)(M,[["render",$],["__scopeId","data-v-119e8a0c"]]);var I=H;const A={id:"connection-status"};function P(e,t,r,s,i,o){return(0,n.uX)(),(0,n.CE)("div",A,[(0,n.Lk)("span",{class:(0,d.C4)(["status",r.status.toLowerCase()])},[t[0]||(t[0]=(0,n.Lk)("span",{class:"dot"},null,-1)),(0,n.eW)(" "+(0,d.v_)("Connected"===r.status?"Соединение установлено":"Нет соединения"),1)],2)])}var T={props:["status"]};const D=(0,C.A)(T,[["render",P],["__scopeId","data-v-547d0f41"]]);var G=D;const q={id:"control-panel"},z={class:"buttons"},K={class:"horizontal-buttons"};function N(e,t,r,s,i,o){return(0,n.uX)(),(0,n.CE)("div",q,[(0,n.Lk)("div",z,[(0,n.Lk)("button",{onClick:t[0]||(t[0]=t=>e.$emit("move","up"))},"⬆"),(0,n.Lk)("div",K,[(0,n.Lk)("button",{onClick:t[1]||(t[1]=t=>e.$emit("move","left"))},"⬅"),(0,n.Lk)("button",{onClick:t[2]||(t[2]=t=>e.$emit("move","right"))},"➡")]),(0,n.Lk)("button",{onClick:t[3]||(t[3]=t=>e.$emit("move","down"))},"⬇")])])}var Q={};const V=(0,C.A)(Q,[["render",N],["__scopeId","data-v-3c180ee8"]]);var W=V,J=r(3819);const R=async(e,t)=>{try{const r=await J.A.get(`https://caranferen.ru/api/space/locate?x=${e}&y=${t}`);return r.data}catch(r){return r.response?console.error("Server responded with an error:",r.response.data):r.request?console.error("No response from server:",r.request):console.error("Error setting up request:",r.message),{status:"failure",message:"Error connecting to base"}}};var U={components:{FlatMap:X,FuelGauge:Y,ShipHealth:I,ConnectionStatus:G,ControlPanel:W},data(){return{mapObjects:[],fuelLevel:100,shipHealth:100,connectionStatus:"Connected",currentX:0,currentY:0,viewX:0,viewY:0,width:1600,height:840,gameOver:!1,fuelBarrels:0}},methods:{restartGame(){this.fuelLevel=100,this.shipHealth=100,this.currentX=0,this.currentY=0,this.viewX=-100,this.viewY=-100,this.mapObjects=[],this.connectionStatus="Connected",this.gameOver=!1,this.fuelBarrels=0},async moveShip(e){if(this.fuelLevel<=0||this.shipHealth<=0)return void(this.gameOver=!0);let t=this.currentX,r=this.currentY;switch(e){case"up":r-=20;break;case"down":r+=20;break;case"left":t-=20;break;case"right":t+=20;break}try{const s=await R(t,r);if("success"===s.status){if(this.fuelLevel-=5,this.fuelLevel<=0)return this.fuelLevel=0,void(this.gameOver=!0);if(this.mapObjects=s.items,this.shipHealth-=s.damage,this.shipHealth<=0)return this.shipHealth=0,void(this.gameOver=!0);this.currentX=t,this.currentY=r,this.viewX=this.currentX-this.width/2,this.viewY=this.currentY-this.height/2;const e=s.items.filter((e=>"fuel_barrel"===e.type)).length;this.fuelBarrels=e,e>0&&(this.fuelLevel=Math.min(this.fuelLevel+5*e,100)),this.connectionStatus="Connected"}else this.connectionStatus="Disconnected",alert("Проблемы с соединением. Попытка повторного соединения..."),await this.moveShip(e)}catch(s){console.error("Ошибка при попытке отправить запрос:",s),s.response&&s.response.status>=400&&s.response.status<600?(this.errorMessage=`Ошибка ${s.response.status}: ${s.response.statusText}. Попробуйте снова.`,this.showErrorModal=!0,this.retryDirection=e):(this.connectionStatus="Disconnected",alert("Проблемы с соединением. Попытка повторного соединения..."),await this.moveShip(e))}},retryConnection(){this.showErrorModal=!1,this.retryDirection&&this.moveShip(this.retryDirection)}}};const Z=(0,C.A)(U,[["render",h],["__scopeId","data-v-109fee78"]]);var ee=Z;(0,s.Ef)(ee).mount("#app")},2348:function(e,t,r){e.exports=r.p+"img/asteroid.c69020d0.svg"},6169:function(e,t,r){e.exports=r.p+"img/spaceship.975bcc70.svg"}},t={};function r(s){var n=t[s];if(void 0!==n)return n.exports;var i=t[s]={exports:{}};return e[s].call(i.exports,i,i.exports,r),i.exports}r.m=e,function(){var e=[];r.O=function(t,s,n,i){if(!s){var o=1/0;for(u=0;u<e.length;u++){s=e[u][0],n=e[u][1],i=e[u][2];for(var a=!0,c=0;c<s.length;c++)(!1&i||o>=i)&&Object.keys(r.O).every((function(e){return r.O[e](s[c])}))?s.splice(c--,1):(a=!1,i<o&&(o=i));if(a){e.splice(u--,1);var l=n();void 0!==l&&(t=l)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[s,n,i]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){r.p="/spaceship-dashboard/"}(),function(){var e={524:0};r.O.j=function(t){return 0===e[t]};var t=function(t,s){var n,i,o=s[0],a=s[1],c=s[2],l=0;if(o.some((function(t){return 0!==e[t]}))){for(n in a)r.o(a,n)&&(r.m[n]=a[n]);if(c)var u=c(r)}for(t&&t(s);l<o.length;l++)i=o[l],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(u)},s=self["webpackChunkspaceship_dashboard"]=self["webpackChunkspaceship_dashboard"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=r.O(void 0,[504],(function(){return r(4081)}));s=r.O(s)})();
//# sourceMappingURL=app.128834da.js.map